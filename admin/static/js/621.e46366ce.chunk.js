"use strict";(self.webpackChunkplenticode_g3_admin=self.webpackChunkplenticode_g3_admin||[]).push([[621],{6621:(t,e,s)=>{s.r(e),s.d(e,{default:()=>b});var i=s(4473),a=s(8341),o=s(9379),n=s(5043),l=s(9826),p=s(8128),r=s(3969),c=s(3133),h=s(4630),d=s(579);const u=(t,e,s)=>(0,o.A)({backgroundColor:(0,l.e$)(t,s)},e.applyStyles("light",{backgroundColor:(0,l.a)(t,s)})),v=(0,p.Ay)(c.z)(t=>{let{theme:e}=t;return{"& .super-app-theme--Preselected":(0,o.A)((0,o.A)({},u(e.palette.success.main,e,.7)),{},{"&:hover":(0,o.A)({},u(e.palette.success.main,e,.6)),"&.Mui-selected":(0,o.A)((0,o.A)({},u(e.palette.success.main,e,.5)),{},{"&:hover":(0,o.A)({},u(e.palette.success.main,e,.4))})}),"& .super-app-theme--Options":(0,o.A)((0,o.A)({},u(e.palette.background.default,e,.7)),{},{"&:hover":(0,o.A)({},u(e.palette.info.main,e,.6)),"&.Mui-selected":(0,o.A)((0,o.A)({},u(e.palette.info.main,e,.5)),{},{"&:hover":(0,o.A)({},u(e.palette.info.main,e,.4))})})}});var S=(0,a.A)("translateDescription");class m extends n.Component{constructor(t){super(t),this.onAliveChanged=(t,e)=>{t===this.aliveId&&this.setState({isInstanceAlive:e&&e.val})},this.onStateChanged=(t,e)=>{if(t===this.allAvailableId){let t;try{t=e&&e.val?JSON.parse(e.val):[],(0,i.A)(m,S)[S](t),this.updateDataWithOptionals(t)}catch(s){t=[]}this.setState({allavailable:t})}},this.onRowSelectionModelChange=t=>{this.setState({rowSelectionModel:t});let e=[];for(const s of t){let t=this.state.allavailable.find(t=>t.id===s);t&&e.push(t)}this.props.onChange("processdata"===this.props.type?"pdoptionals":"settingoptionals",JSON.stringify(e))},this.onProcessUpdateRow=t=>{if(this.state.rowSelectionModel.includes(t.id)){let s=[];try{s=JSON.parse(this.optionalsId)}catch(e){}let i=s.find(e=>e.id===t.id);i&&(i.description=t.description),this.props.onChange("processdata"===this.props.type?"pdoptionals":"settingoptionals",JSON.stringify(s))}return t},this.state={inAction:!1,toast:"",isInstanceAlive:!1,errorWithPercent:!1,availabledata:[],rowSelectionModel:[]},this.aliveId="system.adapter.".concat(this.props.adapterName,".").concat(this.props.instance,".alive"),this.allAvailableId="".concat(this.props.adapterName,".").concat(this.props.instance,".").concat(this.props.type,".all-available"),this.optionalsId="processdata"===this.props.type?this.props.native.pdoptionals:this.props.native.settingoptionals,this.columns=[{field:"id",headerName:"ID",minWidth:200,editable:!1,flex:1},{field:"description",headerName:h.F2.t("Description"),minWidth:150,editable:!0,flex:1}]}updateDataWithOptionals(t){let e=[],s=[];try{s=JSON.parse(this.optionalsId)}catch(i){}for(const a of s){let s=t.find(t=>t.id===a.id);s&&!s.preset&&(s.description=a.description,e.push(s.id))}this.setState({rowSelectionModel:e})}readStatus(t){this.props.socket.getState(this.aliveId).then(e=>this.props.socket.getState(this.allAvailableId).then(s=>{let a;try{a=s&&s.val?JSON.parse(s.val):[],(0,i.A)(m,S)[S](a),this.updateDataWithOptionals(a)}catch(o){a=[]}this.setState({isInstanceAlive:e&&e.val,allavailable:a},()=>t&&t())}))}componentDidMount(){this.props.socket.getState(this.aliveId).then(t=>{this.setState({isInstanceAlive:t&&t.val}),this.readStatus(()=>{this.props.socket.subscribeState(this.aliveId,this.onAliveChanged),this.props.socket.subscribeState(this.allAvailableId,this.onStateChanged)})})}componentWillUnmount(){this.props.socket.unsubscribeState(this.aliveId,this.onAliveChanged),this.props.socket.unsubscribeState(this.allAvailableId,this.onStateChanged)}render(){return(0,d.jsxs)("form",{children:[(0,d.jsx)(h.gu,{instance:this.props.instance,common:this.props.common,native:this.props.native,onError:t=>this.setState({errorText:t}),onLoad:this.props.onLoad}),(0,d.jsx)(r.A,{sx:{height:"100%",width:"100%",pb:10},children:(0,d.jsx)(v,{rows:this.state.allavailable,columns:this.columns,checkboxSelection:!0,disableRowSelectionOnClick:!0,rowHeight:30,isRowSelectable:t=>!1===t.row.preselected,isCellEditable:t=>!1===t.row.preselected,getRowClassName:t=>t.row.preselected?"super-app-theme--Preselected":"super-app-theme--Options",processRowUpdate:(t,e)=>this.onProcessUpdateRow(t,e),rowSelectionModel:this.state.rowSelectionModel,onRowSelectionModelChange:t=>this.onRowSelectionModelChange(t)})})]})}}Object.defineProperty(m,S,{value:function(t){for(let e of t)e.description&&(e.description=e.description[h.F2.getLanguage()])}});const b=m}}]);
//# sourceMappingURL=621.e46366ce.chunk.js.map